"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[190],{78536:function(I,y,s){s.d(y,{$6:function(){return p},MZ:function(){return x},Yt:function(){return f},Z1:function(){return j},av:function(){return S},lu:function(){return Z}});var m=s(27023),o="/",Z=function(){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/baseCheck",method:"get"})},x=function(l){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/testDatabase",method:"post",data:l})},j=function(l){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/writeEnv",method:"post",data:l})},p=function(){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/installWeb",method:"post",timeout:10*60*1e3})},f=function(){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/installSql",method:"post",timeout:10*60*1e3})},S=function(l){return(0,m.Z)({baseURL:o,url:"/index.php?s=/api/install/setUser",method:"post",data:l})}},43355:function(I,y,s){s.r(y),s.d(y,{default:function(){return M}});var m=s(90228),o=s.n(m),Z=s(87999),x=s.n(Z),j=s(48305),p=s.n(j),f=s(75271),S=s(55865),r=s(99159),l=s(2762),D=s(35845),F=s(79376),u=s(95933),A=s(38687),h=s(46985),w=s(81905),b=s(78536),e=s(52676),M=function(){var g=(0,S.s0)(),C=r.Z.useForm(),P=p()(C,1),q=P[0],B=(0,f.useState)(!1),L=p()(B,2),c=L[0],v=L[1];(0,f.useEffect)(function(){if(v(!0),!localStorage.getItem("status")||!localStorage.getItem("time")||localStorage.getItem("status")!=="second"){g("/",{replace:!0});return}var d=Number(localStorage.getItem("time")),t=Date.now();if(d+36e5<t){l.ZP.warning("\u5B89\u88C5\u72B6\u6001\u8FC7\u671F\uFF01").then(),g("/",{replace:!0}),localStorage.clear();return}if(localStorage.getItem("data")){var a=localStorage.getItem("data");a=JSON.parse(a),q.setFieldsValue(a)}v(!1)},[]);var Q=function(){g("/",{replace:!0}),localStorage.clear()},U={web_title:"Xin Admin",username:"admin",password:"",repassword:"",mysql_hostname:"127.0.0.1",mysql_username:"root",mysql_password:"",mysql_port:"3306",mysql_name:"",mysql_prefix:"xin_"},R=function(){var t=q.getFieldsValue();if(console.log(t),!t.mysql_hostname||!t.mysql_username||!t.mysql_password||!t.mysql_port||!t.mysql_name){l.ZP.error("\u8BF7\u5B8C\u6574\u8F93\u5165\u6570\u636E\u5E93\u4FE1\u606F\uFF01").then();return}var a={mysql_hostname:t.mysql_hostname,mysql_username:t.mysql_username,mysql_password:t.mysql_password,mysql_port:t.mysql_port,mysql_name:t.mysql_name};v(!0),(0,b.MZ)(a).then(function(){l.ZP.success("\u6570\u636E\u5E93\u94FE\u63A5\u6210\u529F")}).catch(function(i){l.ZP.error(i.response.data.msg)}).finally(function(){v(!1)})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(r.Z,{layout:"vertical",variant:"filled",autoComplete:"off",form:q,initialValues:U,onFinish:function(){var d=x()(o()().mark(function t(a){var i;return o()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={mysql_hostname:a.mysql_hostname,mysql_username:a.mysql_username,mysql_password:a.mysql_password,mysql_port:a.mysql_port,mysql_name:a.mysql_name},n.prev=1,n.next=4,(0,b.MZ)(i);case 4:localStorage.setItem("status","third"),localStorage.setItem("time",String(Date.now())),i.username=a.username,i.password=a.password,i.web_title=a.web_title,i.mysql_prefix=a.mysql_prefix,localStorage.setItem("data",JSON.stringify(i)),g("/third",{replace:!0}),n.next=19;break;case 14:return n.prev=14,n.t0=n.catch(1),console.log(n.t0),l.ZP.error(n.t0.response.data.msg),n.abrupt("return",!1);case 19:case"end":return n.stop()}},t,null,[[1,14]])}));return function(t){return d.apply(this,arguments)}}(),children:[(0,e.jsx)(D.Z,{spinning:c,children:(0,e.jsxs)("div",{className:"form-body",children:[(0,e.jsx)(F.Z.Title,{level:4,style:{textAlign:"center"},children:"\u7F51\u7AD9\u914D\u7F6E"}),(0,e.jsx)(r.Z.Item,{label:"\u7F51\u7AD9\u540D\u79F0",name:"web_title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u540D\u79F0!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"\u7BA1\u7406\u5458\u8D26\u53F7",name:"username",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7BA1\u7406\u5458\u8D26\u53F7!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"\u7BA1\u7406\u5458\u5BC6\u7801",name:"password",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7BA1\u7406\u5458\u5BC6\u7801!"}],children:(0,e.jsx)(u.Z.Password,{})}),(0,e.jsx)(r.Z.Item,{label:"\u91CD\u590D\u7BA1\u7406\u5458\u5BC6\u7801",name:"repassword",dependencies:["password"],rules:[{required:!0,message:"\u8BF7\u91CD\u590D\u8F93\u5165\u7BA1\u7406\u5458\u5BC6\u7801!"},function(d){var t=d.getFieldValue;return{validator:function(i,E){return!E||t("password")===E?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u540C\uFF01"))}}}],children:(0,e.jsx)(u.Z.Password,{})})]})}),(0,e.jsx)(D.Z,{spinning:c,children:(0,e.jsxs)("div",{className:"form-body",children:[(0,e.jsx)(F.Z.Title,{level:4,style:{textAlign:"center"},children:"\u6570\u636E\u5E93\u914D\u7F6E"}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u6570\u636E\u5E93\u5730\u5740",name:"mysql_hostname",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL \u6570\u636E\u5E93\u5730\u5740!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u8FDE\u63A5\u7528\u6237\u540D",name:"mysql_username",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL \u8FDE\u63A5\u7528\u6237\u540D!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u8FDE\u63A5\u5BC6\u7801",name:"mysql_password",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL  \u8FDE\u63A5\u5BC6\u7801!"}],children:(0,e.jsx)(u.Z.Password,{})}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u8FDE\u63A5\u7AEF\u53E3\u53F7",name:"mysql_port",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL \u8FDE\u63A5\u7AEF\u53E3\u53F7!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u6570\u636E\u5E93\u540D",name:"mysql_name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL \u6570\u636E\u5E93\u540D!"}],children:(0,e.jsx)(u.Z,{})}),(0,e.jsx)(r.Z.Item,{label:"MySQL \u6570\u636E\u8868\u524D\u7F00",name:"mysql_prefix",rules:[{required:!0,message:"\u8BF7\u8F93\u5165MySQL \u6570\u636E\u8868\u524D\u7F00!"}],children:(0,e.jsx)(u.Z,{})})]})}),(0,e.jsxs)(A.Z,{gap:"small",wrap:!0,justify:"flex-end",children:[(0,e.jsxs)(h.ZP,{type:"link",style:{color:"#ffa940"},children:[(0,e.jsx)(w.Z,{})," \u83B7\u53D6\u5E2E\u52A9"]}),(0,e.jsx)(h.ZP,{type:"primary",onClick:Q,loading:c,children:"\u4E0A\u4E00\u6B65"}),(0,e.jsx)(h.ZP,{type:"primary",onClick:R,loading:c,children:"\u6D4B\u8BD5\u6570\u636E\u5E93\u94FE\u63A5"}),(0,e.jsx)(h.ZP,{type:"primary",htmlType:"submit",loading:c,children:"\u4E0B\u4E00\u6B65"})]})]})})}}}]);
