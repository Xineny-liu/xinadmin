"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[697],{78536:function(R,v,a){a.d(v,{$6:function(){return h},MZ:function(){return F},Yt:function(){return d},Z1:function(){return Z},av:function(){return l},lu:function(){return E}});var u=a(27023),n="/",E=function(){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/baseCheck",method:"get"})},F=function(i){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/testDatabase",method:"post",data:i})},Z=function(i){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/writeEnv",method:"post",data:i})},h=function(){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/installWeb",method:"post",timeout:10*60*1e3})},d=function(){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/installSql",method:"post",timeout:10*60*1e3})},l=function(i){return(0,u.Z)({baseURL:n,url:"/index.php?s=/api/install/setUser",method:"post",data:i})}},54480:function(R,v,a){a.r(v),a.d(v,{default:function(){return T}});var u=a(90228),n=a.n(u),E=a(87999),F=a.n(E),Z=a(48305),h=a.n(Z),d=a(75271),l=a(2762),r=a(94889),i=a(35845),P=a(38922),j=a(46985),U=a(9999),L=a(55865),o=a(20662),I=a(62952),p=a(78536),e=a(52676),T=function(){var f=(0,L.s0)(),k=(0,d.useState)(!1),D=h()(k,2),x=D[0],m=D[1],w=(0,d.useState)({mysql_hostname:"",mysql_username:"",mysql_password:"",mysql_port:"",mysql_name:"",mysql_prefix:"",web_title:"",username:"",password:""}),B=h()(w,2),c=B[0],N=B[1],W=(0,d.useState)(!1),A=h()(W,2),O=A[0],z=A[1];(0,d.useEffect)(function(){if(!localStorage.getItem("status")||!localStorage.getItem("time")||localStorage.getItem("status")!=="third"||!localStorage.getItem("data")){f("/",{replace:!0});return}var g=Number(localStorage.getItem("time")),y=Date.now();if(g+36e5<y){l.ZP.warning("\u5B89\u88C5\u72B6\u6001\u8FC7\u671F\uFF01").then(),f("/",{replace:!0}),localStorage.clear();return}var t=JSON.parse(localStorage.getItem("data"));if(!t.mysql_hostname||!t.mysql_username||!t.mysql_password||!t.mysql_port||!t.mysql_name||!t.mysql_prefix||!t.web_title||!t.password||!t.username){l.ZP.warning("\u53C2\u6570\u7F3A\u5931\uFF0C\u8BF7\u91CD\u65B0\u5B89\u88C5\uFF01").then(),f("/",{replace:!0}),localStorage.clear();return}N(t)},[]);var M=[{key:"2",label:"\u7CFB\u7EDF\u73AF\u5883",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}}),"  ","\u9A8C\u8BC1\u5B8C\u6210"]})},{key:"3",label:"\u6570\u636E\u5E93\u94FE\u63A5",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}}),"  ","\u94FE\u63A5\u6210\u529F"]})},{key:"1",label:"\u7F51\u7AD9\u540D\u79F0",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}})," ",c.web_title," "]})},{key:"4",label:"\u6570\u636E\u5E93\u5730\u5740",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}})," ",c.mysql_hostname]})},{key:"9",label:"\u6570\u636E\u5E93\u7AEF\u53E3",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}})," ",c.mysql_port," "]})},{key:"7",label:"\u6570\u636E\u5E93\u540D",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}})," ",c.mysql_name]})},{key:"8",label:"\u6570\u636E\u5E93\u524D\u7F00",children:(0,e.jsxs)(r.Z,{children:[" ",(0,e.jsx)(o.Z,{style:{color:"#52c41a"}})," ",c.mysql_prefix]})}],$=function(){localStorage.setItem("status","second"),setTimeout(function(){f("/second",{replace:!0})})},G=function(){var g=F()(n()().mark(function y(){var t,b,C,S;return n()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return m(!0),s.prev=1,s.next=4,(0,p.Z1)(c);case 4:if(t=s.sent,t.data.success){s.next=9;break}return l.ZP.warning("\u5199\u5165ENV\u6587\u4EF6\u5931\u8D25\uFF1A"+t.data.msg),m(!1),s.abrupt("return");case 9:return s.next=11,(0,p.$6)();case 11:if(b=s.sent,b.data.success){s.next=16;break}return l.ZP.warning("\u5B89\u88C5\u524D\u7AEF\u4F9D\u8D56\u5931\u8D25\uFF1A"+b.data.msg),m(!1),s.abrupt("return");case 16:return s.next=18,(0,p.Yt)();case 18:if(C=s.sent,C.data.success){s.next=23;break}return l.ZP.warning("\u6570\u636E\u5E93\u8FC1\u79FB\u5931\u8D25\uFF1A"+C.data.msg),m(!1),s.abrupt("return");case 23:return s.next=25,(0,p.av)(c);case 25:if(S=s.sent,S.data.success){s.next=30;break}return l.ZP.warning("\u8BBE\u7F6E\u7528\u6237\u5931\u8D25\uFF1A"+S.data.msg),m(!1),s.abrupt("return");case 30:m(!1),z(!0),l.ZP.success("\u5B89\u88C5\u6210\u529F"),s.next=39;break;case 35:s.prev=35,s.t0=s.catch(1),console.error(s.t0),l.ZP.error("\u5B89\u88C5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 log \u6216 \u65E5\u5FD7\u6587\u4EF6\uFF01");case 39:case"end":return s.stop()}},y,null,[[1,35]])}));return function(){return g.apply(this,arguments)}}();return(0,e.jsx)(e.Fragment,{children:O?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(U.ZP,{status:"success",title:(0,e.jsx)("div",{style:{marginBottom:30},children:"\u606D\u559C\u4F60\uFF0C\u5DF2\u7ECF\u5B89\u88C5\u6210\u529F\uFF01"}),subTitle:(0,e.jsxs)("div",{className:"install-ok",children:[(0,e.jsx)("div",{style:{color:"#000"},children:"\u8BF7\u6309\u7167\u4EE5\u4E0B\u64CD\u4F5C\u8BBF\u95EE\uFF1A"}),(0,e.jsx)("div",{children:"1\u3001\u6253\u5F00\u547D\u4EE4\u884C\u7A97\u53E3\uFF0C\u5E76\u5207\u6362\u5230\u524D\u7AEF\u9879\u76EE\u76EE\u5F55\u3002\u9ED8\u8BA4\u524D\u7AEF\u9879\u76EE\u76EE\u5F55\uFF1Aweb"}),(0,e.jsx)("div",{children:"2\u3001\u6267\u884C\u547D\u4EE4\u542F\u52A8\u524D\u7AEF\u9879\u76EE\uFF1Apnpm run dev"}),(0,e.jsxs)("div",{children:["3\u3001\u8BBF\u95EE\uFF1A",(0,e.jsx)("a",{href:"http://localhost:3000",children:"http://localhost:3000"})]}),(0,e.jsx)("div",{children:"\u6CE8\u610F\uFF1A\u5B89\u88C5\u540E\u8BF7\u5220\u9664 install \u76EE\u5F55"})]}),extra:[(0,e.jsx)(j.ZP,{type:"primary",children:"\u91CD\u65B0\u5B89\u88C5"},"console")]})}):(0,e.jsx)(i.Z,{tip:"Loading",size:"large",spinning:x,children:(0,e.jsxs)("div",{className:"install-body",children:[(0,e.jsx)(P.Z,{column:1,bordered:!0,items:M}),(0,e.jsxs)("div",{className:"button",children:[(0,e.jsx)(j.ZP,{type:"primary",loading:x,size:"large",onClick:$,style:{marginRight:20},children:" \u4E0A\u4E00\u6B65 "}),(0,e.jsx)(j.ZP,{type:"primary",loading:x,size:"large",onClick:G,icon:(0,e.jsx)(I.Z,{}),children:" \u5F00\u59CB\u5B89\u88C5 "})]})]})})})}}}]);
